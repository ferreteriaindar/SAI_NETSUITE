using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using SAI_NETSUITE.Models.Catalogos;
using Newtonsoft.Json;
using System.Net;
using System.IO;
using System.Xml;

namespace SAI_NETSUITE.Views.Contabilidad
{
    public partial class TimbradoPrueba : UserControl
    {
        public TimbradoPrueba()
        {
            InitializeComponent();
        }

        private void btngetxmlPRE_Click(object sender, EventArgs e)
        {
            SAI_NETSUITE.IWS.Connection con = new SAI_NETSUITE.IWS.Connection();
            string json = con.GET("api/Timbrado/GetXMLPreTimbrado?compid=5327814&invoiceid="+txtPagoID.Text+"&idsetup=2&type=customerpayment", SAI_NETSUITE.Properties.Resources.token);
            respuesta r = JsonConvert.DeserializeObject<respuesta>(json);
            textBox1.Text = r.result;
                
            
        }

        private void simpleButton1_Click(object sender, EventArgs e)
        {
            Console.WriteLine(Timbrar(""));
            
            
        }


        public string Timbrar(string bla)
        {
            try
            {
                string xml = @" <? xml version = ""1.0"" encoding = ""utf - 8"" ?> < soap : Envelope xmlns: xsi =\""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:soap=""http://schemas.xmlsoap.org/soap/envelope/""> <soap:Body> <RequestTransaction xmlns=""http://www.fact.com.mx/schema/ws""> <Requestor>51ac27f9-c394-495e-a0df-0e01423e975f</Requestor> <Transaction>CONVERT_NATIVE_XML</Transaction> <Country>MX</Country> <Entity>FIN870710Q40</Entity> <User>51ac27f9-c394-495e-a0df-0e01423e975f</User> <UserName>MX.FIN870710Q40.admin</UserName> <Data1>&lt;fx:FactDocMX xmlns:fx=""http://www.fact.com.mx/schema/fx"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:schemaLocation=""http://www.fact.com.mx/schema/fx http://www.mysuitemex.com/fact/schema/fx_2010_f.xsd""&gt;&lt;fx:Version&gt;7&lt;/fx:Version&gt;&lt;fx:Identificacion&gt;&lt;fx:CdgPaisEmisor&gt;MX&lt;/fx:CdgPaisEmisor&gt;&lt;fx:TipoDeComprobante&gt;PAGO&lt;/fx:TipoDeComprobante&gt;&lt;fx:RFCEmisor&gt;FIN870710Q40&lt;/fx:RFCEmisor&gt;&lt;fx:RazonSocialEmisor&gt;Ferreteria Indar SA de CV&lt;/fx:RazonSocialEmisor&gt;&lt;fx:Usuario&gt;admin&lt;/fx:Usuario&gt;&lt;fx:NumeroInterno&gt;PAGO: 1777&lt;/fx:NumeroInterno&gt;&lt;fx:AsignacionSolicitada&gt;&lt;fx:Folio&gt;1777&lt;/fx:Folio&gt;&lt;/fx:AsignacionSolicitada&gt;&lt;fx:LugarExpedicion&gt;45620&lt;/fx:LugarExpedicion&gt;&lt;/fx:Identificacion&gt;&lt;fx:Procesamiento&gt;&lt;fx:Dictionary name=""email""&gt;&lt;fx:Entry k=""to"" v=""nvafersol@gmail.com;sistemas@indar.com.mx""/&gt;&lt;/fx:Dictionary&gt;&lt;/fx:Procesamiento&gt;&lt;fx:Emisor&gt;&lt;fx:DomicilioFiscal&gt;&lt;fx:Calle&gt;Carretera El Verde San Martin De las Flores&lt;/fx:Calle&gt;&lt;fx:NumeroExterior&gt;480&lt;/fx:NumeroExterior&gt;&lt;fx:NumeroInterior&gt;NA&lt;/fx:NumeroInterior&gt;&lt;fx:Municipio&gt;Jalisco&lt;/fx:Municipio&gt;&lt;fx:Estado&gt;Guadalajara&lt;/fx:Estado&gt;&lt;fx:Pais&gt;MEX&lt;/fx:Pais&gt;&lt;fx:CodigoPostal&gt;45620&lt;/fx:CodigoPostal&gt;&lt;/fx:DomicilioFiscal&gt;&lt;fx:DomicilioDeEmision&gt;&lt;fx:Calle&gt;Carretera El Verde San Martin De las Flores&lt;/fx:Calle&gt;&lt;fx:NumeroExterior&gt;480&lt;/fx:NumeroExterior&gt;&lt;fx:Localidad&gt;Tlaquepaque&lt;/fx:Localidad&gt;&lt;fx:Colonia&gt;San Martin de las Flores&lt;/fx:Colonia&gt;&lt;fx:Municipio&gt;Jalisco&lt;/fx:Municipio&gt;&lt;fx:Estado&gt;Guadalajara&lt;/fx:Estado&gt;&lt;fx:Pais&gt;MEX&lt;/fx:Pais&gt;&lt;fx:CodigoPostal&gt;45620&lt;/fx:CodigoPostal&gt;&lt;/fx:DomicilioDeEmision&gt;&lt;fx:RegimenFiscal&gt;&lt;fx:Regimen&gt;601&lt;/fx:Regimen&gt;&lt;/fx:RegimenFiscal&gt;&lt;/fx:Emisor&gt;&lt;fx:Receptor&gt;&lt;fx:CdgPaisReceptor&gt;MX&lt;/fx:CdgPaisReceptor&gt;&lt;fx:RFCReceptor&gt;NFS9006229Q2&lt;/fx:RFCReceptor&gt;&lt;fx:NombreReceptor&gt;NUEVA FERRETERIA SOL SA DE CV&lt;/fx:NombreReceptor&gt;&lt;fx:Domicilio&gt;&lt;fx:DomicilioFiscalMexicano&gt;&lt;fx:Calle&gt;RIO NILO 1659&lt;/fx:Calle&gt;&lt;fx:Municipio&gt;Guadalajara&lt;/fx:Municipio&gt;&lt;fx:Estado&gt;Jalisco&lt;/fx:Estado&gt;&lt;fx:Pais&gt;MEXICO&lt;/fx:Pais&gt;&lt;fx:CodigoPostal&gt;44870&lt;/fx:CodigoPostal&gt;&lt;/fx:DomicilioFiscalMexicano&gt;&lt;/fx:Domicilio&gt;&lt;fx:UsoCFDI&gt;P01&lt;/fx:UsoCFDI&gt;&lt;/fx:Receptor&gt;&lt;fx:Conceptos&gt;&lt;fx:Concepto&gt;&lt;fx:Cantidad&gt;1&lt;/fx:Cantidad&gt;&lt;fx:ClaveUnidad&gt;ACT&lt;/fx:ClaveUnidad&gt;&lt;fx:ClaveProdServ&gt;84111506&lt;/fx:ClaveProdServ&gt;&lt;fx:Descripcion&gt;Pago&lt;/fx:Descripcion&gt;&lt;fx:ValorUnitario&gt;0&lt;/fx:ValorUnitario&gt;&lt;fx:Importe&gt;0&lt;/fx:Importe&gt;&lt;/fx:Concepto&gt;&lt;/fx:Conceptos&gt;&lt;fx:Totales&gt;&lt;fx:Moneda&gt;XXX&lt;/fx:Moneda&gt;&lt;fx:SubTotalBruto&gt;0&lt;/fx:SubTotalBruto&gt;&lt;fx:SubTotal&gt;0&lt;/fx:SubTotal&gt;&lt;fx:Total&gt;0&lt;/fx:Total&gt;&lt;fx:TotalEnLetra&gt;cero  00/100&lt;/fx:TotalEnLetra&gt;&lt;/fx:Totales&gt;&lt;fx:Complementos&gt;&lt;fx:Pagos Version=""1.0""&gt;&lt;fx:Pago FechaPago=""2019-11-29T12:00:00"" FormaDePagoP=""03"" MonedaP=""MXN"" Monto=""41313.71"" CtaBeneficiario=""00020039981""&gt;&lt;fx:DoctoRelacionado IdDocumento=""8B3DC429-BAFA-4C43-9FBA-45533E8B93C8"" Serie=""SI- 1415042"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""3067.58"" ImpPagado=""3067.58"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""F6C7B709-2BFF-459A-8DF9-ACFE4BF00952"" Serie=""SI- 1415183"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""9826.69"" ImpPagado=""9826.69"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""37E404FB-BE3F-47CE-A049-DEAA8EA52660"" Serie=""SI- 1415735"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""6825.55"" ImpPagado=""6825.55"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""29843869-361F-492F-9D46-AD8A7040E2B8"" Serie=""SI- 1415550"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""1524.74"" ImpPagado=""1524.74"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""B8763EDE-763F-4699-8338-02BFB314C387"" Serie=""SI- 1415745"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""3790.46"" ImpPagado=""3790.46"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""5E020340-83F3-44CA-B000-BF4066996758"" Serie=""SI- 1415024"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""567.58"" ImpPagado=""567.58"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""720B6C8C-CC96-4D8F-8028-903BAE6ADCD3"" Serie=""SI- 1415549"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""1247.25"" ImpPagado=""1247.25"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""E4630C0B-82CC-434E-910B-835545C24F48"" Serie=""SI- 1415701"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""1482.70"" ImpPagado=""1482.70"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""CAC3A7C0-BEC0-4AE9-9316-6A5EE22564E5"" Serie=""SI- 1415705"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""9805.00"" ImpPagado=""9805.00"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""76C6EBE2-92AE-4FDB-9F31-BCA432A991CF"" Serie=""SI- 1415481"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""539.60"" ImpPagado=""539.60"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""B2E064E7-70A1-4DEF-84C4-4F24A5729506"" Serie=""SI- 1415737"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""2636.56"" ImpPagado=""2636.56"" ImpSaldoInsoluto=""0.00""/&gt;&lt;/fx:Pago&gt;&lt;/fx:Pagos&gt;&lt;/fx:Complementos&gt;&lt;fx:ComprobanteEx&gt;&lt;fx:DatosDeNegocio&gt;&lt;fx:Sucursal&gt;PAGOS&lt;/fx:Sucursal&gt;&lt;/fx:DatosDeNegocio&gt;&lt;/fx:ComprobanteEx&gt;&lt;/fx:FactDocMX&gt;</Data1> <Data2>XML PDF</Data2> <Data3></Data3> </RequestTransaction> </soap:Body> </soap:Envelope> ";
                HttpWebRequest request = (HttpWebRequest)WebRequest.Create("https://www.mysuitecfdi.com/mx.com.fact.wsfront/factwsfront.asmx");
                request.ContentType = "text/xml";
                request.Method = "POST";
               /*// request.Headers.Add("Content-Type", "text/xml");
                request.Headers.Add("Content-Length", xml.Length.ToString());
                request.Headers.Add("SOAPAction", "http://www.fact.com.mx/schema/ws/RequestTransaction");
                */

                using (var streamWriter = new StreamWriter(request.GetRequestStream()))
                {
                    streamWriter.Write(@"<?xml version=""1.0"" encoding=""utf - 8""?> <soap:Envelope xmlns:xsi=\""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:soap=""http://schemas.xmlsoap.org/soap/envelope/""> <soap:Body> <RequestTransaction xmlns=""http://www.fact.com.mx/schema/ws""> <Requestor>51ac27f9-c394-495e-a0df-0e01423e975f</Requestor> <Transaction>CONVERT_NATIVE_XML</Transaction> <Country>MX</Country> <Entity>FIN870710Q40</Entity> <User>51ac27f9-c394-495e-a0df-0e01423e975f</User> <UserName>MX.FIN870710Q40.admin</UserName> <Data1>&lt;fx:FactDocMX xmlns:fx=""http://www.fact.com.mx/schema/fx"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:schemaLocation=""http://www.fact.com.mx/schema/fx http://www.mysuitemex.com/fact/schema/fx_2010_f.xsd""&gt;&lt;fx:Version&gt;7&lt;/fx:Version&gt;&lt;fx:Identificacion&gt;&lt;fx:CdgPaisEmisor&gt;MX&lt;/fx:CdgPaisEmisor&gt;&lt;fx:TipoDeComprobante&gt;PAGO&lt;/fx:TipoDeComprobante&gt;&lt;fx:RFCEmisor&gt;FIN870710Q40&lt;/fx:RFCEmisor&gt;&lt;fx:RazonSocialEmisor&gt;Ferreteria Indar SA de CV&lt;/fx:RazonSocialEmisor&gt;&lt;fx:Usuario&gt;admin&lt;/fx:Usuario&gt;&lt;fx:NumeroInterno&gt;PAGO: 1777&lt;/fx:NumeroInterno&gt;&lt;fx:AsignacionSolicitada&gt;&lt;fx:Folio&gt;1777&lt;/fx:Folio&gt;&lt;/fx:AsignacionSolicitada&gt;&lt;fx:LugarExpedicion&gt;45620&lt;/fx:LugarExpedicion&gt;&lt;/fx:Identificacion&gt;&lt;fx:Procesamiento&gt;&lt;fx:Dictionary name=""email""&gt;&lt;fx:Entry k=""to"" v=""nvafersol@gmail.com;sistemas@indar.com.mx""/&gt;&lt;/fx:Dictionary&gt;&lt;/fx:Procesamiento&gt;&lt;fx:Emisor&gt;&lt;fx:DomicilioFiscal&gt;&lt;fx:Calle&gt;Carretera El Verde San Martin De las Flores&lt;/fx:Calle&gt;&lt;fx:NumeroExterior&gt;480&lt;/fx:NumeroExterior&gt;&lt;fx:NumeroInterior&gt;NA&lt;/fx:NumeroInterior&gt;&lt;fx:Municipio&gt;Jalisco&lt;/fx:Municipio&gt;&lt;fx:Estado&gt;Guadalajara&lt;/fx:Estado&gt;&lt;fx:Pais&gt;MEX&lt;/fx:Pais&gt;&lt;fx:CodigoPostal&gt;45620&lt;/fx:CodigoPostal&gt;&lt;/fx:DomicilioFiscal&gt;&lt;fx:DomicilioDeEmision&gt;&lt;fx:Calle&gt;Carretera El Verde San Martin De las Flores&lt;/fx:Calle&gt;&lt;fx:NumeroExterior&gt;480&lt;/fx:NumeroExterior&gt;&lt;fx:Localidad&gt;Tlaquepaque&lt;/fx:Localidad&gt;&lt;fx:Colonia&gt;San Martin de las Flores&lt;/fx:Colonia&gt;&lt;fx:Municipio&gt;Jalisco&lt;/fx:Municipio&gt;&lt;fx:Estado&gt;Guadalajara&lt;/fx:Estado&gt;&lt;fx:Pais&gt;MEX&lt;/fx:Pais&gt;&lt;fx:CodigoPostal&gt;45620&lt;/fx:CodigoPostal&gt;&lt;/fx:DomicilioDeEmision&gt;&lt;fx:RegimenFiscal&gt;&lt;fx:Regimen&gt;601&lt;/fx:Regimen&gt;&lt;/fx:RegimenFiscal&gt;&lt;/fx:Emisor&gt;&lt;fx:Receptor&gt;&lt;fx:CdgPaisReceptor&gt;MX&lt;/fx:CdgPaisReceptor&gt;&lt;fx:RFCReceptor&gt;NFS9006229Q2&lt;/fx:RFCReceptor&gt;&lt;fx:NombreReceptor&gt;NUEVA FERRETERIA SOL SA DE CV&lt;/fx:NombreReceptor&gt;&lt;fx:Domicilio&gt;&lt;fx:DomicilioFiscalMexicano&gt;&lt;fx:Calle&gt;RIO NILO 1659&lt;/fx:Calle&gt;&lt;fx:Municipio&gt;Guadalajara&lt;/fx:Municipio&gt;&lt;fx:Estado&gt;Jalisco&lt;/fx:Estado&gt;&lt;fx:Pais&gt;MEXICO&lt;/fx:Pais&gt;&lt;fx:CodigoPostal&gt;44870&lt;/fx:CodigoPostal&gt;&lt;/fx:DomicilioFiscalMexicano&gt;&lt;/fx:Domicilio&gt;&lt;fx:UsoCFDI&gt;P01&lt;/fx:UsoCFDI&gt;&lt;/fx:Receptor&gt;&lt;fx:Conceptos&gt;&lt;fx:Concepto&gt;&lt;fx:Cantidad&gt;1&lt;/fx:Cantidad&gt;&lt;fx:ClaveUnidad&gt;ACT&lt;/fx:ClaveUnidad&gt;&lt;fx:ClaveProdServ&gt;84111506&lt;/fx:ClaveProdServ&gt;&lt;fx:Descripcion&gt;Pago&lt;/fx:Descripcion&gt;&lt;fx:ValorUnitario&gt;0&lt;/fx:ValorUnitario&gt;&lt;fx:Importe&gt;0&lt;/fx:Importe&gt;&lt;/fx:Concepto&gt;&lt;/fx:Conceptos&gt;&lt;fx:Totales&gt;&lt;fx:Moneda&gt;XXX&lt;/fx:Moneda&gt;&lt;fx:SubTotalBruto&gt;0&lt;/fx:SubTotalBruto&gt;&lt;fx:SubTotal&gt;0&lt;/fx:SubTotal&gt;&lt;fx:Total&gt;0&lt;/fx:Total&gt;&lt;fx:TotalEnLetra&gt;cero  00/100&lt;/fx:TotalEnLetra&gt;&lt;/fx:Totales&gt;&lt;fx:Complementos&gt;&lt;fx:Pagos Version=""1.0""&gt;&lt;fx:Pago FechaPago=""2019-11-29T12:00:00"" FormaDePagoP=""03"" MonedaP=""MXN"" Monto=""41313.71"" CtaBeneficiario=""00020039981""&gt;&lt;fx:DoctoRelacionado IdDocumento=""8B3DC429-BAFA-4C43-9FBA-45533E8B93C8"" Serie=""SI- 1415042"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""3067.58"" ImpPagado=""3067.58"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""F6C7B709-2BFF-459A-8DF9-ACFE4BF00952"" Serie=""SI- 1415183"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""9826.69"" ImpPagado=""9826.69"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""37E404FB-BE3F-47CE-A049-DEAA8EA52660"" Serie=""SI- 1415735"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""6825.55"" ImpPagado=""6825.55"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""29843869-361F-492F-9D46-AD8A7040E2B8"" Serie=""SI- 1415550"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""1524.74"" ImpPagado=""1524.74"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""B8763EDE-763F-4699-8338-02BFB314C387"" Serie=""SI- 1415745"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""3790.46"" ImpPagado=""3790.46"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""5E020340-83F3-44CA-B000-BF4066996758"" Serie=""SI- 1415024"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""567.58"" ImpPagado=""567.58"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""720B6C8C-CC96-4D8F-8028-903BAE6ADCD3"" Serie=""SI- 1415549"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""1247.25"" ImpPagado=""1247.25"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""E4630C0B-82CC-434E-910B-835545C24F48"" Serie=""SI- 1415701"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""1482.70"" ImpPagado=""1482.70"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""CAC3A7C0-BEC0-4AE9-9316-6A5EE22564E5"" Serie=""SI- 1415705"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""9805.00"" ImpPagado=""9805.00"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""76C6EBE2-92AE-4FDB-9F31-BCA432A991CF"" Serie=""SI- 1415481"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""539.60"" ImpPagado=""539.60"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""B2E064E7-70A1-4DEF-84C4-4F24A5729506"" Serie=""SI- 1415737"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""2636.56"" ImpPagado=""2636.56"" ImpSaldoInsoluto=""0.00""/&gt;&lt;/fx:Pago&gt;&lt;/fx:Pagos&gt;&lt;/fx:Complementos&gt;&lt;fx:ComprobanteEx&gt;&lt;fx:DatosDeNegocio&gt;&lt;fx:Sucursal&gt;PAGOS&lt;/fx:Sucursal&gt;&lt;/fx:DatosDeNegocio&gt;&lt;/fx:ComprobanteEx&gt;&lt;/fx:FactDocMX&gt;</Data1> <Data2>XML PDF</Data2> <Data3></Data3> </RequestTransaction> </soap:Body> </soap:Envelope> ");
                    streamWriter.Flush();
                }

                string content = "Content-Type: text/xml; charset=utf-8";
                string length = "Content-Length: " + xml.Length.ToString();
                string soap = "SOAPAction: " + "http://www.fact.com.mx/schema/ws/RequestTransaction";
               // request.Headers.Add(HttpRequestHeader.ContentType, "text/xml; charset=utf-8");
               // request.Headers.Add(HttpRequestHeader.ContentLength, xml.Length.ToString());
               // request.Headers.Add("SOAPAction", "http://www.fact.com.mx/schema/ws/RequestTransaction");

                HttpWebResponse response = (HttpWebResponse)request.GetResponse();
                using (var streamReader = new StreamReader(response.GetResponseStream()))
                {
                    string responseText = streamReader.ReadToEnd();

                    return responseText;

                }
            }
            catch (Exception ex)
            {
                return ex.Message;
            }
        }

        private void simpleButton2_Click(object sender, EventArgs e)
        {
            string xmlMessage = @" <? xml version = ""1.0"" encoding = ""utf - 8"" ?> < soap : Envelope xmlns: xsi =\""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:soap=""http://schemas.xmlsoap.org/soap/envelope/""> <soap:Body> <RequestTransaction xmlns=""http://www.fact.com.mx/schema/ws""> <Requestor>51ac27f9-c394-495e-a0df-0e01423e975f</Requestor> <Transaction>CONVERT_NATIVE_XML</Transaction> <Country>MX</Country> <Entity>FIN870710Q40</Entity> <User>51ac27f9-c394-495e-a0df-0e01423e975f</User> <UserName>MX.FIN870710Q40.admin</UserName> <Data1>&lt;fx:FactDocMX xmlns:fx=""http://www.fact.com.mx/schema/fx"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:schemaLocation=""http://www.fact.com.mx/schema/fx http://www.mysuitemex.com/fact/schema/fx_2010_f.xsd""&gt;&lt;fx:Version&gt;7&lt;/fx:Version&gt;&lt;fx:Identificacion&gt;&lt;fx:CdgPaisEmisor&gt;MX&lt;/fx:CdgPaisEmisor&gt;&lt;fx:TipoDeComprobante&gt;PAGO&lt;/fx:TipoDeComprobante&gt;&lt;fx:RFCEmisor&gt;FIN870710Q40&lt;/fx:RFCEmisor&gt;&lt;fx:RazonSocialEmisor&gt;Ferreteria Indar SA de CV&lt;/fx:RazonSocialEmisor&gt;&lt;fx:Usuario&gt;admin&lt;/fx:Usuario&gt;&lt;fx:NumeroInterno&gt;PAGO: 1777&lt;/fx:NumeroInterno&gt;&lt;fx:AsignacionSolicitada&gt;&lt;fx:Folio&gt;1777&lt;/fx:Folio&gt;&lt;/fx:AsignacionSolicitada&gt;&lt;fx:LugarExpedicion&gt;45620&lt;/fx:LugarExpedicion&gt;&lt;/fx:Identificacion&gt;&lt;fx:Procesamiento&gt;&lt;fx:Dictionary name=""email""&gt;&lt;fx:Entry k=""to"" v=""nvafersol@gmail.com;sistemas@indar.com.mx""/&gt;&lt;/fx:Dictionary&gt;&lt;/fx:Procesamiento&gt;&lt;fx:Emisor&gt;&lt;fx:DomicilioFiscal&gt;&lt;fx:Calle&gt;Carretera El Verde San Martin De las Flores&lt;/fx:Calle&gt;&lt;fx:NumeroExterior&gt;480&lt;/fx:NumeroExterior&gt;&lt;fx:NumeroInterior&gt;NA&lt;/fx:NumeroInterior&gt;&lt;fx:Municipio&gt;Jalisco&lt;/fx:Municipio&gt;&lt;fx:Estado&gt;Guadalajara&lt;/fx:Estado&gt;&lt;fx:Pais&gt;MEX&lt;/fx:Pais&gt;&lt;fx:CodigoPostal&gt;45620&lt;/fx:CodigoPostal&gt;&lt;/fx:DomicilioFiscal&gt;&lt;fx:DomicilioDeEmision&gt;&lt;fx:Calle&gt;Carretera El Verde San Martin De las Flores&lt;/fx:Calle&gt;&lt;fx:NumeroExterior&gt;480&lt;/fx:NumeroExterior&gt;&lt;fx:Localidad&gt;Tlaquepaque&lt;/fx:Localidad&gt;&lt;fx:Colonia&gt;San Martin de las Flores&lt;/fx:Colonia&gt;&lt;fx:Municipio&gt;Jalisco&lt;/fx:Municipio&gt;&lt;fx:Estado&gt;Guadalajara&lt;/fx:Estado&gt;&lt;fx:Pais&gt;MEX&lt;/fx:Pais&gt;&lt;fx:CodigoPostal&gt;45620&lt;/fx:CodigoPostal&gt;&lt;/fx:DomicilioDeEmision&gt;&lt;fx:RegimenFiscal&gt;&lt;fx:Regimen&gt;601&lt;/fx:Regimen&gt;&lt;/fx:RegimenFiscal&gt;&lt;/fx:Emisor&gt;&lt;fx:Receptor&gt;&lt;fx:CdgPaisReceptor&gt;MX&lt;/fx:CdgPaisReceptor&gt;&lt;fx:RFCReceptor&gt;NFS9006229Q2&lt;/fx:RFCReceptor&gt;&lt;fx:NombreReceptor&gt;NUEVA FERRETERIA SOL SA DE CV&lt;/fx:NombreReceptor&gt;&lt;fx:Domicilio&gt;&lt;fx:DomicilioFiscalMexicano&gt;&lt;fx:Calle&gt;RIO NILO 1659&lt;/fx:Calle&gt;&lt;fx:Municipio&gt;Guadalajara&lt;/fx:Municipio&gt;&lt;fx:Estado&gt;Jalisco&lt;/fx:Estado&gt;&lt;fx:Pais&gt;MEXICO&lt;/fx:Pais&gt;&lt;fx:CodigoPostal&gt;44870&lt;/fx:CodigoPostal&gt;&lt;/fx:DomicilioFiscalMexicano&gt;&lt;/fx:Domicilio&gt;&lt;fx:UsoCFDI&gt;P01&lt;/fx:UsoCFDI&gt;&lt;/fx:Receptor&gt;&lt;fx:Conceptos&gt;&lt;fx:Concepto&gt;&lt;fx:Cantidad&gt;1&lt;/fx:Cantidad&gt;&lt;fx:ClaveUnidad&gt;ACT&lt;/fx:ClaveUnidad&gt;&lt;fx:ClaveProdServ&gt;84111506&lt;/fx:ClaveProdServ&gt;&lt;fx:Descripcion&gt;Pago&lt;/fx:Descripcion&gt;&lt;fx:ValorUnitario&gt;0&lt;/fx:ValorUnitario&gt;&lt;fx:Importe&gt;0&lt;/fx:Importe&gt;&lt;/fx:Concepto&gt;&lt;/fx:Conceptos&gt;&lt;fx:Totales&gt;&lt;fx:Moneda&gt;XXX&lt;/fx:Moneda&gt;&lt;fx:SubTotalBruto&gt;0&lt;/fx:SubTotalBruto&gt;&lt;fx:SubTotal&gt;0&lt;/fx:SubTotal&gt;&lt;fx:Total&gt;0&lt;/fx:Total&gt;&lt;fx:TotalEnLetra&gt;cero  00/100&lt;/fx:TotalEnLetra&gt;&lt;/fx:Totales&gt;&lt;fx:Complementos&gt;&lt;fx:Pagos Version=""1.0""&gt;&lt;fx:Pago FechaPago=""2019-11-29T12:00:00"" FormaDePagoP=""03"" MonedaP=""MXN"" Monto=""41313.71"" CtaBeneficiario=""00020039981""&gt;&lt;fx:DoctoRelacionado IdDocumento=""8B3DC429-BAFA-4C43-9FBA-45533E8B93C8"" Serie=""SI- 1415042"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""3067.58"" ImpPagado=""3067.58"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""F6C7B709-2BFF-459A-8DF9-ACFE4BF00952"" Serie=""SI- 1415183"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""9826.69"" ImpPagado=""9826.69"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""37E404FB-BE3F-47CE-A049-DEAA8EA52660"" Serie=""SI- 1415735"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""6825.55"" ImpPagado=""6825.55"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""29843869-361F-492F-9D46-AD8A7040E2B8"" Serie=""SI- 1415550"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""1524.74"" ImpPagado=""1524.74"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""B8763EDE-763F-4699-8338-02BFB314C387"" Serie=""SI- 1415745"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""3790.46"" ImpPagado=""3790.46"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""5E020340-83F3-44CA-B000-BF4066996758"" Serie=""SI- 1415024"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""567.58"" ImpPagado=""567.58"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""720B6C8C-CC96-4D8F-8028-903BAE6ADCD3"" Serie=""SI- 1415549"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""1247.25"" ImpPagado=""1247.25"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""E4630C0B-82CC-434E-910B-835545C24F48"" Serie=""SI- 1415701"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""1482.70"" ImpPagado=""1482.70"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""CAC3A7C0-BEC0-4AE9-9316-6A5EE22564E5"" Serie=""SI- 1415705"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""9805.00"" ImpPagado=""9805.00"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""76C6EBE2-92AE-4FDB-9F31-BCA432A991CF"" Serie=""SI- 1415481"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""539.60"" ImpPagado=""539.60"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""B2E064E7-70A1-4DEF-84C4-4F24A5729506"" Serie=""SI- 1415737"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""2636.56"" ImpPagado=""2636.56"" ImpSaldoInsoluto=""0.00""/&gt;&lt;/fx:Pago&gt;&lt;/fx:Pagos&gt;&lt;/fx:Complementos&gt;&lt;fx:ComprobanteEx&gt;&lt;fx:DatosDeNegocio&gt;&lt;fx:Sucursal&gt;PAGOS&lt;/fx:Sucursal&gt;&lt;/fx:DatosDeNegocio&gt;&lt;/fx:ComprobanteEx&gt;&lt;/fx:FactDocMX&gt;</Data1> <Data2>XML PDF</Data2> <Data3></Data3> </RequestTransaction> </soap:Body> </soap:Envelope> ";
            string url = "https://www.mysuitecfdi.com/mx.com.fact.wsfront/factwsfront.asmx";
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
            byte[] bytes;
            bytes = System.Text.Encoding.ASCII.GetBytes("*");
            request.ContentType = "text/xml; encoding='utf-8'";
            request.ContentLength = bytes.Length;
            request.Headers.Add("SOAPAction", "http://www.fact.com.mx/schema/ws/RequestTransaction");
            request.Method = "POST";
            Stream requestStream = request.GetRequestStream();
            requestStream.Write(bytes, 0, bytes.Length);
            requestStream.Close();
            HttpWebResponse response;
            response = (HttpWebResponse)request.GetResponse();
            if (response.StatusCode == HttpStatusCode.OK)
            {
                Stream responseStream = response.GetResponseStream();
                string responseStr = new StreamReader(responseStream).ReadToEnd();
                Console.WriteLine(responseStr);
            }
            
        }

        private void simpleButton4_Click(object sender, EventArgs e)
        {
           
            string sRequestor = "51ac27f9-c394-495e-a0df-0e01423e975f";
            string sEntity = "FIN870710Q40";
            string sUser = "51ac27f9-c394-495e-a0df-0e01423e975f";
            string sUserName = "MX.FIN870710Q40.admin";
            string xmlMessage = @" <? xml version = ""1.0"" encoding = ""utf - 8"" ?> < soap : Envelope xmlns: xsi =\""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:soap=""http://schemas.xmlsoap.org/soap/envelope/""> <soap:Body> <RequestTransaction xmlns=""http://www.fact.com.mx/schema/ws""> <Requestor>51ac27f9-c394-495e-a0df-0e01423e975f</Requestor> <Transaction>CONVERT_NATIVE_XML</Transaction> <Country>MX</Country> <Entity>FIN870710Q40</Entity> <User>51ac27f9-c394-495e-a0df-0e01423e975f</User> <UserName>MX.FIN870710Q40.admin</UserName> <Data1>&lt;fx:FactDocMX xmlns:fx=""http://www.fact.com.mx/schema/fx"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:schemaLocation=""http://www.fact.com.mx/schema/fx http://www.mysuitemex.com/fact/schema/fx_2010_f.xsd""&gt;&lt;fx:Version&gt;7&lt;/fx:Version&gt;&lt;fx:Identificacion&gt;&lt;fx:CdgPaisEmisor&gt;MX&lt;/fx:CdgPaisEmisor&gt;&lt;fx:TipoDeComprobante&gt;PAGO&lt;/fx:TipoDeComprobante&gt;&lt;fx:RFCEmisor&gt;FIN870710Q40&lt;/fx:RFCEmisor&gt;&lt;fx:RazonSocialEmisor&gt;Ferreteria Indar SA de CV&lt;/fx:RazonSocialEmisor&gt;&lt;fx:Usuario&gt;admin&lt;/fx:Usuario&gt;&lt;fx:NumeroInterno&gt;PAGO: 1777&lt;/fx:NumeroInterno&gt;&lt;fx:AsignacionSolicitada&gt;&lt;fx:Folio&gt;1777&lt;/fx:Folio&gt;&lt;/fx:AsignacionSolicitada&gt;&lt;fx:LugarExpedicion&gt;45620&lt;/fx:LugarExpedicion&gt;&lt;/fx:Identificacion&gt;&lt;fx:Procesamiento&gt;&lt;fx:Dictionary name=""email""&gt;&lt;fx:Entry k=""to"" v=""nvafersol@gmail.com;sistemas@indar.com.mx""/&gt;&lt;/fx:Dictionary&gt;&lt;/fx:Procesamiento&gt;&lt;fx:Emisor&gt;&lt;fx:DomicilioFiscal&gt;&lt;fx:Calle&gt;Carretera El Verde San Martin De las Flores&lt;/fx:Calle&gt;&lt;fx:NumeroExterior&gt;480&lt;/fx:NumeroExterior&gt;&lt;fx:NumeroInterior&gt;NA&lt;/fx:NumeroInterior&gt;&lt;fx:Municipio&gt;Jalisco&lt;/fx:Municipio&gt;&lt;fx:Estado&gt;Guadalajara&lt;/fx:Estado&gt;&lt;fx:Pais&gt;MEX&lt;/fx:Pais&gt;&lt;fx:CodigoPostal&gt;45620&lt;/fx:CodigoPostal&gt;&lt;/fx:DomicilioFiscal&gt;&lt;fx:DomicilioDeEmision&gt;&lt;fx:Calle&gt;Carretera El Verde San Martin De las Flores&lt;/fx:Calle&gt;&lt;fx:NumeroExterior&gt;480&lt;/fx:NumeroExterior&gt;&lt;fx:Localidad&gt;Tlaquepaque&lt;/fx:Localidad&gt;&lt;fx:Colonia&gt;San Martin de las Flores&lt;/fx:Colonia&gt;&lt;fx:Municipio&gt;Jalisco&lt;/fx:Municipio&gt;&lt;fx:Estado&gt;Guadalajara&lt;/fx:Estado&gt;&lt;fx:Pais&gt;MEX&lt;/fx:Pais&gt;&lt;fx:CodigoPostal&gt;45620&lt;/fx:CodigoPostal&gt;&lt;/fx:DomicilioDeEmision&gt;&lt;fx:RegimenFiscal&gt;&lt;fx:Regimen&gt;601&lt;/fx:Regimen&gt;&lt;/fx:RegimenFiscal&gt;&lt;/fx:Emisor&gt;&lt;fx:Receptor&gt;&lt;fx:CdgPaisReceptor&gt;MX&lt;/fx:CdgPaisReceptor&gt;&lt;fx:RFCReceptor&gt;NFS9006229Q2&lt;/fx:RFCReceptor&gt;&lt;fx:NombreReceptor&gt;NUEVA FERRETERIA SOL SA DE CV&lt;/fx:NombreReceptor&gt;&lt;fx:Domicilio&gt;&lt;fx:DomicilioFiscalMexicano&gt;&lt;fx:Calle&gt;RIO NILO 1659&lt;/fx:Calle&gt;&lt;fx:Municipio&gt;Guadalajara&lt;/fx:Municipio&gt;&lt;fx:Estado&gt;Jalisco&lt;/fx:Estado&gt;&lt;fx:Pais&gt;MEXICO&lt;/fx:Pais&gt;&lt;fx:CodigoPostal&gt;44870&lt;/fx:CodigoPostal&gt;&lt;/fx:DomicilioFiscalMexicano&gt;&lt;/fx:Domicilio&gt;&lt;fx:UsoCFDI&gt;P01&lt;/fx:UsoCFDI&gt;&lt;/fx:Receptor&gt;&lt;fx:Conceptos&gt;&lt;fx:Concepto&gt;&lt;fx:Cantidad&gt;1&lt;/fx:Cantidad&gt;&lt;fx:ClaveUnidad&gt;ACT&lt;/fx:ClaveUnidad&gt;&lt;fx:ClaveProdServ&gt;84111506&lt;/fx:ClaveProdServ&gt;&lt;fx:Descripcion&gt;Pago&lt;/fx:Descripcion&gt;&lt;fx:ValorUnitario&gt;0&lt;/fx:ValorUnitario&gt;&lt;fx:Importe&gt;0&lt;/fx:Importe&gt;&lt;/fx:Concepto&gt;&lt;/fx:Conceptos&gt;&lt;fx:Totales&gt;&lt;fx:Moneda&gt;XXX&lt;/fx:Moneda&gt;&lt;fx:SubTotalBruto&gt;0&lt;/fx:SubTotalBruto&gt;&lt;fx:SubTotal&gt;0&lt;/fx:SubTotal&gt;&lt;fx:Total&gt;0&lt;/fx:Total&gt;&lt;fx:TotalEnLetra&gt;cero  00/100&lt;/fx:TotalEnLetra&gt;&lt;/fx:Totales&gt;&lt;fx:Complementos&gt;&lt;fx:Pagos Version=""1.0""&gt;&lt;fx:Pago FechaPago=""2019-11-29T12:00:00"" FormaDePagoP=""03"" MonedaP=""MXN"" Monto=""41313.71"" CtaBeneficiario=""00020039981""&gt;&lt;fx:DoctoRelacionado IdDocumento=""8B3DC429-BAFA-4C43-9FBA-45533E8B93C8"" Serie=""SI- 1415042"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""3067.58"" ImpPagado=""3067.58"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""F6C7B709-2BFF-459A-8DF9-ACFE4BF00952"" Serie=""SI- 1415183"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""9826.69"" ImpPagado=""9826.69"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""37E404FB-BE3F-47CE-A049-DEAA8EA52660"" Serie=""SI- 1415735"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""6825.55"" ImpPagado=""6825.55"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""29843869-361F-492F-9D46-AD8A7040E2B8"" Serie=""SI- 1415550"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""1524.74"" ImpPagado=""1524.74"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""B8763EDE-763F-4699-8338-02BFB314C387"" Serie=""SI- 1415745"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""3790.46"" ImpPagado=""3790.46"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""5E020340-83F3-44CA-B000-BF4066996758"" Serie=""SI- 1415024"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""567.58"" ImpPagado=""567.58"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""720B6C8C-CC96-4D8F-8028-903BAE6ADCD3"" Serie=""SI- 1415549"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""1247.25"" ImpPagado=""1247.25"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""E4630C0B-82CC-434E-910B-835545C24F48"" Serie=""SI- 1415701"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""1482.70"" ImpPagado=""1482.70"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""CAC3A7C0-BEC0-4AE9-9316-6A5EE22564E5"" Serie=""SI- 1415705"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""9805.00"" ImpPagado=""9805.00"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""76C6EBE2-92AE-4FDB-9F31-BCA432A991CF"" Serie=""SI- 1415481"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""539.60"" ImpPagado=""539.60"" ImpSaldoInsoluto=""0.00""/&gt;&lt;fx:DoctoRelacionado IdDocumento=""B2E064E7-70A1-4DEF-84C4-4F24A5729506"" Serie=""SI- 1415737"" MonedaDR=""MXN"" MetodoDePagoDR=""PPD"" NumParcialidad=""1"" ImpSaldoAnt=""2636.56"" ImpPagado=""2636.56"" ImpSaldoInsoluto=""0.00""/&gt;&lt;/fx:Pago&gt;&lt;/fx:Pagos&gt;&lt;/fx:Complementos&gt;&lt;fx:ComprobanteEx&gt;&lt;fx:DatosDeNegocio&gt;&lt;fx:Sucursal&gt;PAGOS&lt;/fx:Sucursal&gt;&lt;/fx:DatosDeNegocio&gt;&lt;/fx:ComprobanteEx&gt;&lt;/fx:FactDocMX&gt;</Data1> <Data2>XML PDF</Data2> <Data3></Data3> </RequestTransaction> </soap:Body> </soap:Envelope> ";
            
           
            string sData2 = "XML_PDF";
            string sData3 = "";
            /*
            MySuite.TransactionTag tag;
            MySuite.FactWSFrontSoapClient c = new MySuite.FactWSFrontSoapClient();
            MySuite.FactResponseData respuesta2;
            MySuite.FactResponse respError;*/

            
        }

        private void BTNCORRIGE_Click(object sender, EventArgs e)
        {
                               string pago = "9608";
            Models.Transaccion.corrigePago cp = new Models.Transaccion.corrigePago();
            DirectoryInfo taskDirectory = new DirectoryInfo(@"C:\Users\RVELASCO\Downloads\");
            FileInfo[] taskFiles = taskDirectory.GetFiles("FIN870710Q40__"+pago+"*.xml");
            Console.WriteLine(taskFiles[0].FullName);
           string output= File.ReadAllText(taskFiles[0].FullName);
            cp.xml = output;
            FileInfo[] taskFiles2 = taskDirectory.GetFiles("FIN870710Q40__"+pago+"*.pdf");
            string pdf = Convert.ToBase64String(File.ReadAllBytes(taskFiles2[0].FullName));
            cp.pdf = pdf;
            cp.internalId = 99824;
            cp.xml = "";

            IWS.Connection connection = new IWS.Connection();
            string json = JsonConvert.SerializeObject(cp);
         /*   string resultado = connection.POST("script=560&deploy=1", json, SAI_NETSUITE.Properties.Resources.token);
            Console.WriteLine(resultado); */
        }
    }
}
